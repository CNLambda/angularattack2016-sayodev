{"version":3,"file":"chat.component.js","sourceRoot":"","sources":["chat.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { Component, OnInit, Output, EventEmitter } from '@angular/core';\nimport { SessionService } from '../session.service';\n\n@Component({\n  moduleId: module.id,\n  selector: 'chat',\n  templateUrl: 'chat.component.html',\n  styleUrls: ['chat.component.css']\n})\nexport class ChatComponent implements OnInit {\n\n    @Output() close_chat: EventEmitter<void>;\n    \n    public current_msg: string;\n    public username:string = \"\";\n    public id:string = \"\";\n    public messages: any[]; // {mine: bool, username: str, message: str}\n    public ws: WebSocket;\n\n    constructor(private session: SessionService) {\n        this.close_chat = new EventEmitter<void>();\n    }\n    get_id(x: string) : string {\n        let x2: string[] = x.split(\"/\");\n        if (x2[x2.length - 1] == \"\") {\n            return x2[x2.length - 2];\n        } else {\n            return x2[x2.length - 1];\n        }\n    }\n    ngOnInit() {\n        this.username = this.session.getBoardUsername(this.get_id(window.location.href));\n        this.id = this.get_id(window.location.href);\n        var ws = new WebSocket(\"wss://angularattack2016-sayodev.herokuapp.com/message\");\n        this.ws = ws;\n        var x = this;\n        ws.onopen = function () {\n              ws.send(JSON.stringify({\"username\": x.username, \"message\": \"I'm now online.\", \"board_id\": x.id, \"join\": \"true\"})); \n        };\n\n        // Log errors\n        ws.onerror = function (error) {\n          console.log('WebSocket Error ' + error);\n        };\n        \n        ws.onmessage = function (event) {\n            console.log(event);\n            if(event.data.from == this.username){\n                \n            }\n            \n        };\n        ws.onclose = function() {\n            ws.send(JSON.stringify({\"from\": x.username, \"message\": \"I'm is going offline.\", \"board_id\": x.id}));\n        }\n        \n\n    }\n    \n    send() {\n        this.ws.send(JSON.stringify({'from': this.username, 'message': this.current_msg, \"board_id\": this.id}));\n        this.current_msg='';\n    }\n\n}\n"]}